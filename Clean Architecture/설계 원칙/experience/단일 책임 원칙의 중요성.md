# 단일 책임 원칙의 중요성

## 소상공인 임차인 확인서 발급 시스템

만 1년차 까지 보름이 남은 시점에서 `소상공인 임차인 확인서 발급 시스템`을 구축하는 프로젝트를 담당하게 되었다.

기획자가 담당자와 협의를 통해 요구한 이 시스템 관리자 페이지의 비지니스 로직은 다음과 같다.

- 목록 페이지에서 등록버튼 클릭
- 등록 페이지
  - 개인정보(이름, 생년월일, 연락처) 입력 후 '사용자 조회' 버튼 클릭
    - 사용자 조회 버튼을 클릭 했을 때 발생하는 로직
      - 우리가 생성한 개인정보 P 테이블 조회
      - 내부 DB 개인정보 A 테이블 조회
        - A 테이블에 개인정보가 존재하지 않는 경우
          - 내부 DB 개인정보 B 테이블 조회
            - B 테이블 개인정보가 존재하지 않는 경우
              - C 테이블 조회
                - C 테이블에 개인정보가 존재하지 않는 경우
                  - 모든 폼을 다 작성하고 등록 버튼 누를 때 입력한 개인정보를 P 테이블에 INSERT
            - B 테이블에 개인정보가 존재하는 경우
        - A  테이블에 개인정보가 존재하는 경우
          - (A 테이블에 개인정보가 없고 B 테이블에 존재하는 경우와, C 테이블에 개인정보가 존재하는 경우도 포함)
          - P 테이블과 개인정보 비교 후에 최신 데이터로 P 테이블 개인정보를 UPDATE
            - 이때 비교 조건은 수정일이 존재하는 경우 수정일, 수정일이 없는 경우 등록일을 기준으로 비교하여 어떤 데이터가 최신인지 판단.
      - 개인정보의 DI 값을 기준으로 우리 업체정보 X 테이블 조회
      - 내부 DB 업체정보 Y 테이블 조회
        - Y 테이블에 업체정보가 존재하지 않는 경우
          - 내부 DB 업체정보 Z 테이블 조회
            - Z 테이블에 업체정보가 존재하지 않는 경우
              - 팝업창에 아무런 업체정보가 나오지 않는다.
        - Y 테이블에 업체정보가 존재하는 경우
          - (Y 테이블에 업체정보가 없고, Z 테이블에 있는 경우도 포함)
          - X 테이블과 Y 테이블을 비교 후에 최신 데이터로 X 테이블 업체정보를 UPDATE
  - 나머지 입력 폼 작성
  - 최종 등록 버튼 클릭
    - 이때 발생하는 이벤트
      - 위에서 개인정보와 업체정보를 가져온 경우 JSP 에 hidden 값으로 키값이 바인딩 되어있음
      - `기획자 요구사항`
        - `개인정보와 업체정보를 폼에 바인딩 시켜주고, 잘못된 데이터는 관리자가 수정하여 등록하면 개인정보 P 테이블에 UPDATE 되도록 원함`
      - 이 상태에서 관리자가 아예 다른 사람과, 다른 업체로 수정하려는 경우
        - hidden 에 들어있는 키값은 전 사람인데, 다른 데이터로 수정하여 등록하면 전 사람에 대한 데이터가 새로 작성한 사람으로 바뀌어 버림
        - `비지니스 로직 설계상 문제가 발생`
      
